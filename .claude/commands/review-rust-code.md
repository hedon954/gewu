---
description: 审查本次 git diff 的所有变更，并根据项目"宪法"和静态检查工具给出反馈，最终生成英文 commit message。
model: qwen3-coder-plus
allowed-tools: Read, Grep, Glob, Bash(git diff:*), Bash(cargo clippy:*)
---

你现在是`gewu`项目的首席架构师，你的任务是审查本次的代码变更。

**审查目标：**
以下是本次变更的完整 diff（通过 `git diff HEAD` 获取）。请仔细阅读并分析所有变更内容。

**静态检查初步分析结果：**
这是`cargo clippy`工具对当前代码库的检查报告。如果报告为空，则代表没有发现明显问题。

**审查准则（必须严格遵守）：**
请结合上面的静态检查结果，并根据我们项目根目录下的`.claude/constitution.md`文件定义的开发宪法，对代码进行深入审查。你的审查报告必须围绕以下几条核心原则展开：

1.  **第一条：简单性原则。** 代码是否存在不必要的抽象？是否优先使用了标准库和社区主流库？是否有超出当前功能需求的过度设计？
2.  **第二条：测试先行铁律。** 新功能是否有对应测试？测试是否优先使用表格驱动（Table-Driven）风格？
3.  **第三条：明确性原则。** 错误处理是否都使用了`anyhow::anyhow!("...: {}", err)`进行包装？是否存在裸`.unwrap()`或被`let _ =`丢弃的错误？依赖是否通过函数参数或结构体成员显式注入，而非全局变量？

**输出格式：**
请以Markdown格式，生成一份结构化的审查报告（不要保存成文件，直接输出在控制台）。报告应包含以下部分：

- **总体评价：** 一句话总结代码的整体质量。
- **优点（做得好的地方）：** 列出1-2个最值得称赞的点。
- **待改进项（按优先级排序）：**
  - **[高优先级]:** 必须修改的问题（例如，违反了"宪法"的不可协商条款或`clippy`报告的错误）。
  - **[中优先级]:** 强烈建议修改的问题（例如，设计模式可以优化）。
  - **[低优先级]:** 一些代码风格或可读性的建议。

对于每一个待改进项，请明确指出**文件名、行号、问题描述**，并给出具体的**修改建议**。

**Commit Message 生成：**
审查报告完成后，无论是否有待改进项，都必须生成一条符合 [Conventional Commits](https://www.conventionalcommits.org/) 规范的英文 commit message，格式如下：

```
<type>(<scope>): <subject>

[optional body: 每行不超过72字符，说明 Why 而非 What]
```

- `type` 从以下选择：`feat` / `fix` / `refactor` / `test` / `chore` / `docs`
- `scope` 对应变更所在的模块，如 `adapters`、`services`、`cli`、`domain`、`ports`
- `subject` 使用祈使句，首字母小写，不加句号
- 若变更跨多个模块，`scope` 可省略
